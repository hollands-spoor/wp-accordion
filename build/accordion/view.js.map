{"version":3,"file":"accordion/view.js","mappings":"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","sources":["webpack://accordion/./src/accordion/view.js"],"sourcesContent":["/**\n * Initialize the accordion block.\n * Add event listeners to the accordion panes.\n * Open first pane when collapsed is false.\n * On opening a pane, close all other panes when oneAtATime is true.\n * On opening and closing a pane, set max-height of the pane-content. This allows for css transitions.\n */\n\n\n\ndocument.addEventListener(\"DOMContentLoaded\", function () {\n\tconst accordionBlocks = document.querySelectorAll(\n\t\t\".wp-block-hs-blocks-accordion\",\n\t);\n\n\t/**\n\t * Scrollheight is not correct during transition. So it can not serve during\n\t * transition of the max height of a pane.\n\t *\n\t * Therefore this method is called twice: once before transition with reset = true.\n\t * Then again after transition with reset = false. The parent needs its\n\t * css max-height set afterwards for the case that this parent itself is\n\t * collapsed by the user. All this is only here for the case the accordion\n\t * needs animation by means of .js class-changes and css.\n\t *\n\t * max-height and its css transition seems to be the most used way to animate.\n\t * But maybe something else can be found?\n\t *\n\t * TODO: reset can be called unset, for that is what actually happens during\n\t * the transition.\n\t *\n\t * Traverse upwards in the DOM and find out if accordion-block is inside the pane\n\t * of another accordion-block.\n\t * If so, unset the max-height of the content of that parent pane during\n\t * animation ( i.e. during transition of css max-height ).\n\t * After the transition is done, set\n\t * the max-height back to the content's scrollHeight.\n\t */\n\tconst checkForParentPane = (element, unset) => {\n\t\tconst parentPane = element.closest(\".wp-block-hs-blocks-accordion-pane\");\n\t\tif (parentPane) {\n\t\t\t// If parent pane is closed, which is possible if keyboard is used to set focus to a hidden element, then it should be opened.\n\t\t\tif (! parentPane.classList.contains(\"active\")) {\n\t\t\t\tconst parentHeader = parentPane.querySelector(\".pane-header\");\n\t\t\t\tparentHeader.click();\n\t\t\t}\n\t\t\tconst content = parentPane.querySelector(\".pane-content\");\n\t\t\tif (unset) {\n\t\t\t\tcontent.style.removeProperty('max-height');\n\t\t\t} else {\n\t\t\t\tcontent.style.maxHeight = content.scrollHeight + \"px\";\n\t\t\t}\n\t\t\tconst parentBlock = parentPane.closest(\".wp-block-hs-blocks-accordion\");\n\t\t\tif (parentBlock) {\n\t\t\t\tcheckForParentPane(parentBlock);\n\t\t\t}\n\t\t}\n\t};\n\n\n\t/**\n\t * Get the offset of the element.\n\t * @param {*} el \n\t * @returns {Object} - The offset of the element\n\t */\n\tconst getElementOffset = (el) => {\n\t\tconst rect = el.getBoundingClientRect();\n\t\treturn {\n\t\t  left: rect.left + window.scrollX,\n\t\t  top: rect.top + window.scrollY\n\t\t};\n\t}\n\n\t/**\n\t * Get the height of the element including margins.\t\n\t * @param {*} el \n\t * @returns height of the element\n\t */\n\n\tconst getElementHeight = (el) => {\n\t\tconst styles = window.getComputedStyle(el);\n\t\tconst margin = parseFloat(styles['marginTop']) +\n\t\t\t\t\t parseFloat(styles['marginBottom']);\n\t\treturn Math.ceil(el.offsetHeight + margin);\n\t}\n\n\t/**\n\t * Check all the accordions in the page...\n\t */\n\taccordionBlocks.forEach((block) => {\n\t\tconst oneAtATime = block.getAttribute(\"data-one-at-a-time\") === \"true\";\n\t\tconst collapsed = block.getAttribute(\"data-collapsed\") === \"true\";\n\t\tconst accordionPanes = block.querySelectorAll(\n\t\t\t\":scope > .wp-block-hs-blocks-accordion-pane\",\n\t\t);\n\n\t\t/**\n\t\t * ...and add a click handler to the header of each pane.\n\t\t * Also open the first pane if collapsed is false.\n\t\t * Opening all panes would make the use of an accordion useless.\n\t\t * Ensure accessibility by adding keydown event listener for Enter key.\n\t\t * \n\t\t */\n\t\taccordionPanes.forEach((pane, index) => {\n\t\t\tconst header = pane.querySelector(\".pane-header\");\n\t\t\tconst content = pane.querySelector(\".pane-content\");\n\t\t\t// If collapsed is false, open the first pane\n\t\t\tif (!collapsed && index === 0) {\n\t\t\t\tpane.classList.add(\"active\");\n\t\t\t\tcontent.style.maxHeight = content.scrollHeight + \"px\";\n\t\t\t\tcheckForParentPane(block, false);\n\t\t\t} else {\n\t\t\t\tcontent.style.maxHeight = \"0\";\n\t\t\t}\n\n\t\t\theader.addEventListener(\"click\", function (event) {\n\t\t\t\tif (oneAtATime) {\n\t\t\t\t\t// Close other open panes, i.e. remove 'active' class from all sibling panes\n\t\t\t\t\taccordionPanes.forEach((siblingPane) => {\n\t\t\t\t\t\tif (siblingPane !== pane) {\n\t\t\t\t\t\t\tsiblingPane.classList.remove(\"active\");\n\t\t\t\t\t\t\tsiblingPane.querySelector(\".pane-content\").style.maxHeight = \"0\";\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tpane.classList.toggle(\"active\");\n\t\t\t\tif (pane.classList.contains(\"active\")) {\n\t\t\t\t\tcontent.style.maxHeight = content.scrollHeight + \"px\";\n\t\t\t\t\tpane.classList.add('opening');\n\t\t\t\t\t// Pane can be clicked during animation\n\t\t\t\t\tpane.classList.remove('closing');\n\t\t\t\t\t//scroll to position of the currently opened pane-header. Maybe some previous pane is in the process of closing, so the position is calculated in advance by taking the top of the current accordion block and then add ( index * height of the paneheader ).\n\t\t\t\t\tif( oneAtATime ) {\n\t\t\t\t\t\tconst paneHeaderHeight = getElementHeight( header);\n\t\t\t\t\t\tconst newScrollPosition =  getElementOffset(block).top + ( index * paneHeaderHeight );\n\t\t\t\t\t\tconst currentScrollPosition = document.documentElement.scrollTop; // Check browsersupport for this\n\n\t\t\t\t\t\t// FIXME: This is not working in Firefox. <-- Check this!\n\t\t\t\t\t\t// FIXME: When using mouse, new position can only be smaller, but when using keyboard in nested accordion, it can be larger so check if newly opened pane is below the screen bottom.\n\n\n\t\t\t\t\t\t/** \n\t\t\t\t\t\t * This would be the jquery variant . Time and easing should be in accordance of the css transition of a closing pane\n\t\t\t\t\t\t */\n\n\t\t\t\t\t\t//if (newScrollPosition < currentScrollPosition) {\n\t\t\t\t\t\t//\t$(\"html, body\").animate({ scrollTop: newScrollPosition }, 600, \"swing\");\n\t\t\t\t\t\t//}\n\n\n\t\t\t\t\t\tif( newScrollPosition < currentScrollPosition){\n\n\n\t\t\t\t\t\t\twindow.scrollTo({ top: newScrollPosition, behavior: \"smooth\" });\n\n\n\n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tcontent.style.maxHeight = \"0\";\n\t\t\t\t\t// Pane can be clicked during animation\n\t\t\t\t\tpane.classList.remove('opening');\n\t\t\t\t\tpane.classList.add('closing');\n\n\t\t\t\t}\n\n\t\t\t\t/**\n                 * If url must be changed when a pane is opened, it can be done here. \n\t\t\t\t * However, it assumes header has an id.\n                 * if(pane.classList.contains(\"active\")) {\n                 *   const id = header.id;\n                 *   window.history.pushState(null, null, `#${id}`);\n                 * } else {\n                 *   window.history.pushState(null, null, window.location.pathname);\n                 * }\n                */\n\n\t\t\t\t// Check if current accordion block is in the pane of another accordion.\n\t\t\t\tcheckForParentPane(block, true);\n\t\t\t\tcontent.addEventListener(\n\t\t\t\t\t\"transitionend\",\n\t\t\t\t\tfunction onTransitionEnd(event) {\n\t\t\t\t\t\tif (event.propertyName === \"max-height\") {\n\t\t\t\t\t\t\tcontent.removeEventListener(\"transitionend\", onTransitionEnd);\n\t\t\t\t\t\t\tpane.classList.remove('opening');\n\t\t\t\t\t\t\tpane.classList.remove('closing');\n\t\t\t\t\t\t\tcheckForParentPane(block, false);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t});\n\n\t\t\t\n\t\t\t// Add key down event listener to handle Enter key\n\t\t\t// In a nested accordion, pane-headers in a closed parent pane can receive focus.\n\t\t\t// FIXED: In that case the parent pane should be opened first. It should be done recursively so maybe the checkForParentPane function can be used to this end.\n\t\t\t// \n\t\t\theader.addEventListener(\"keydown\", function (event) {\n\t\t\t\tif (event.code === \"Enter\" || event.key === \"Enter\") {\n\t\t\t\t\tif (document.activeElement === header) {\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\theader.click();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t});\n});\n"],"names":["document","addEventListener","accordionBlocks","querySelectorAll","checkForParentPane","element","unset","parentPane","closest","classList","contains","parentHeader","querySelector","click","content","style","removeProperty","maxHeight","scrollHeight","parentBlock","getElementOffset","el","rect","getBoundingClientRect","left","window","scrollX","top","scrollY","getElementHeight","styles","getComputedStyle","margin","parseFloat","Math","ceil","offsetHeight","forEach","block","oneAtATime","getAttribute","collapsed","accordionPanes","pane","index","header","add","event","siblingPane","remove","toggle","paneHeaderHeight","newScrollPosition","currentScrollPosition","documentElement","scrollTop","scrollTo","behavior","onTransitionEnd","propertyName","removeEventListener","code","key","activeElement","preventDefault","stopPropagation"],"sourceRoot":""}